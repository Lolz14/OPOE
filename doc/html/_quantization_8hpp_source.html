<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OPE: include/stats/Quantization.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OPE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_db020283538f0008ef7319d9c802c6ec.html">stats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Quantization.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_quantization_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#ifndef QUANTIZATION_HPP</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#define QUANTIZATION_HPP</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span>        <span class="comment">// For std::pow, std::abs</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;random&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span>       <span class="comment">// For std::numeric_limits</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span>      <span class="comment">// For std::fixed, std::setprecision</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;tuple&gt;</span>        <span class="comment">// For std::tuple from Utils::argmin</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;omp.h&gt;</span>        <span class="comment">// OpenMP for parallelization</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;../traits/OPOE_traits.hpp&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;../stats/DensityBase.hpp&quot;</span> <span class="comment">// For OPOE::make_normal_density</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;../utils/Utils.hpp&quot;</span>       <span class="comment">// For Utils::argmin, Utils::sample_standard_normal_eigen, Utils::calculate_overall_distortion</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// --- Namespace for Quantization ---</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacestats.html">stats</a> {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="namespacestats.html#a21575c8abdf444ef417939c6d5dbf018">   56</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespacestats.html#a21575c8abdf444ef417939c6d5dbf018">QuantizationProcedure</a> = <a class="code" href="_o_p_o_e__traits_8hpp.html#a23239ce06a79e5103dfdf77c9299f9cc">traits::QuantizationProcedure</a>;<span class="keyword">using</span> <a class="code" href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">StoringVector</a> = <a class="code" href="main_8cpp.html#a2bed6660252a8734620907db5c512d41">traits::DataType::StoringVector</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">using</span> <a class="code" href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">StoringVector</a> = <a class="code" href="main_8cpp.html#a2bed6660252a8734620907db5c512d41">traits::DataType::StoringVector</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="namespacestats.html#a85770edc239c1c8c5bd5029a48749014">   62</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespacestats.html#a85770edc239c1c8c5bd5029a48749014">QuantizerGrid</a> = traits::DataType::StoringMatrix; <span class="comment">// Eigen::Matrix&lt;T, Dim, N&gt; or Dynamic</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> N_po<span class="keywordtype">int</span>s, std::<span class="keywordtype">size_t</span> Dim_val, QuantizationProcedure Procedure, <span class="keyword">typename</span> T = traits::DataType::PolynomialField&gt;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer.html">   73</a></span>&#160;<span class="keyword">class </span><a class="code" href="classstats_1_1_quantizer.html">Quantizer</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> N_po<span class="keywordtype">int</span>s, std::<span class="keywordtype">size_t</span> Dim_val, <span class="keyword">typename</span> T = traits::DataType::PolynomialField&gt;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_base.html">   86</a></span>&#160;<span class="keyword">class </span><a class="code" href="classstats_1_1_quantizer_base.html">QuantizerBase</a> {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    static_assert(N_points &gt; 0, <span class="stringliteral">&quot;Number of quantization points (N_points) must be greater than 0.&quot;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    static_assert(Dim_val &gt; 0, <span class="stringliteral">&quot;Dimension (Dim_val) must be greater than 0.&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_base.html#a5aaa041f23256a56fe92cc690c73b67a">   97</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classstats_1_1_quantizer_base.html#a5aaa041f23256a56fe92cc690c73b67a">QuantizerBase</a>()</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        : <a class="code" href="classstats_1_1_quantizer_base.html#af16831bbe8b705be51d99054603d1cd3">hints</a>(Dim_val, N_points),      <span class="comment">// Dim x N matrix</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          <a class="code" href="classstats_1_1_quantizer_base.html#a039808f597fe95fd6a7d0af2b96ca1ba">quantization</a>(Dim_val, N_points) {} <span class="comment">// Dim x N matrix</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_base.html#a4dda7216581e12762476dd2d554b7a25">  104</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classstats_1_1_quantizer_base.html#a4dda7216581e12762476dd2d554b7a25">~QuantizerBase</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_base.html#aa83be6067337c4e59117b3ee53b94fb5">  111</a></span>&#160;    [[nodiscard]] <span class="keyword">const</span> <a class="code" href="namespacestats.html#a85770edc239c1c8c5bd5029a48749014">QuantizerGrid</a>&amp; <a class="code" href="classstats_1_1_quantizer_base.html#aa83be6067337c4e59117b3ee53b94fb5">getQuantization</a>() const noexcept { <span class="keywordflow">return</span> <a class="code" href="classstats_1_1_quantizer_base.html#a039808f597fe95fd6a7d0af2b96ca1ba">quantization</a>; }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_base.html#abeed508991d5d32ee655484f9998e8b6">  118</a></span>&#160;    [[nodiscard]] std::size_t <a class="code" href="classstats_1_1_quantizer_base.html#abeed508991d5d32ee655484f9998e8b6">getNumPoints</a>() const noexcept { <span class="keywordflow">return</span> N_points; }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_base.html#a3792b9bb0b17cb45889e190877dfcae6">  125</a></span>&#160;    [[nodiscard]] std::size_t <a class="code" href="classstats_1_1_quantizer_base.html#a3792b9bb0b17cb45889e190877dfcae6">getDim</a>() const noexcept { <span class="keywordflow">return</span> Dim_val; }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_base.html#ac80a32f7d50aec8fe22447ba4564a3a2">  132</a></span>&#160;    [[nodiscard]] <span class="keyword">const</span> <a class="code" href="namespacestats.html#a85770edc239c1c8c5bd5029a48749014">QuantizerGrid</a>&amp; <a class="code" href="classstats_1_1_quantizer_base.html#ac80a32f7d50aec8fe22447ba4564a3a2">getHints</a>() const noexcept { <span class="keywordflow">return</span> <a class="code" href="classstats_1_1_quantizer_base.html#af16831bbe8b705be51d99054603d1cd3">hints</a>; }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_base.html#af16831bbe8b705be51d99054603d1cd3">  135</a></span>&#160;    <a class="code" href="namespacestats.html#a85770edc239c1c8c5bd5029a48749014">QuantizerGrid</a> <a class="code" href="classstats_1_1_quantizer_base.html#af16831bbe8b705be51d99054603d1cd3">hints</a>;         </div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_base.html#a039808f597fe95fd6a7d0af2b96ca1ba">  136</a></span>&#160;    <a class="code" href="namespacestats.html#a85770edc239c1c8c5bd5029a48749014">QuantizerGrid</a> <a class="code" href="classstats_1_1_quantizer_base.html#a039808f597fe95fd6a7d0af2b96ca1ba">quantization</a>;  </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;};</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> N_po<span class="keywordtype">int</span>s, <span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html">  150</a></span>&#160;<span class="keyword">class </span><a class="code" href="classstats_1_1_quantizer.html">Quantizer</a>&lt; N_points, 1, <a class="code" href="namespacestats.html#a21575c8abdf444ef417939c6d5dbf018">QuantizationProcedure</a>::<a class="code" href="_o_p_o_e__traits_8hpp.html#a23239ce06a79e5103dfdf77c9299f9cca1c8b97c83b0726216cd5dbc88a64b0ed">Newton</a>, T&gt; : <span class="keyword">public</span> <a class="code" href="classstats_1_1_quantizer_base.html">QuantizerBase</a>&lt;N_points, 1, T&gt; {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#aa5712b536b41bbeee87010bde7cc3c43">  152</a></span>&#160;    <span class="keyword">static</span> constexpr std::size_t Dim = 1; <span class="comment">// Explicitly state Dim for this specialization</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="structstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4_1_1_params.html">  157</a></span>&#160;    <span class="keyword">struct </span>Params {</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="structstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4_1_1_params.html#a8eab44fd7fedfbde92ada99627d03b53">  158</a></span>&#160;        T tolerance{1e-6};            </div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="structstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4_1_1_params.html#a996e51219fc334671e3486ca9dd1d6f4">  159</a></span>&#160;        std::size_t max_iter{100};    </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="structstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4_1_1_params.html#a5e8f7f9d179863fdcb5be05e87ad5722">  167</a></span>&#160;        <a class="code" href="structstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4_1_1_params.html#a5e8f7f9d179863fdcb5be05e87ad5722">Params</a>(T tol = 1e-5, std::size_t max_it = 1000)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            : tolerance(tol), max_iter(max_it) {}</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    };</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#a59c08c7a333926618662d1d67da55cc4">  178</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#a59c08c7a333926618662d1d67da55cc4">Quantizer</a>(<span class="keyword">const</span> Params&amp; params = Params{})</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        : <a class="code" href="classstats_1_1_quantizer_base.html">QuantizerBase&lt;N_points, Dim, T&gt;</a>(), params_(params) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        initializeHints();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#a8824558b30603668d2efd145c1e05ada">  188</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#a8824558b30603668d2efd145c1e05ada">initializeHints</a>() {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        constexpr T a_range = -4.0; <span class="comment">// Range for uniform initialization [-4, 4]</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        constexpr T b_range = 4.0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">        #pragma omp parallel for schedule(static)</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; N_points; ++i) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="comment">// Uniform grid logic for Dim = 1</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="comment">// i-th point (0-indexed) value: a + (b-a) * (2*(i+1) - 1) / (2*N)</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="comment">// or more simply: a + (b-a) * (i + 0.5) / N</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            this-&gt;hints(0, i) = a_range + (b_range - a_range) * (<span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(i) + <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(0.5)) / <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(N_points);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#a06dedc6d4d63f79b17201282f2ffa973">  208</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#a06dedc6d4d63f79b17201282f2ffa973">run</a>() {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">StoringVector</a> x = this-&gt;hints.row(0).transpose(); </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <a class="code" href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">StoringVector</a> grad(N_points);                     </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">StoringVector</a> hessian_diag(N_points);             </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;[Info] Newton: Starting optimization for &quot;</span> &lt;&lt; N_points &lt;&lt; <span class="stringliteral">&quot; points.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">for</span> (std::size_t iter = 0; iter &lt; params_.max_iter; ++iter) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            computeGradientAndHessian(x, grad, hessian_diag);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            T grad_norm = grad.template lpNorm&lt;Eigen::Infinity&gt;(); <span class="comment">// Max absolute gradient component</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="comment">// std::cout &lt;&lt; &quot;[Debug] Newton Iter &quot; &lt;&lt; iter &lt;&lt; &quot;: Grad Norm = &quot; &lt;&lt; grad_norm &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">if</span> (grad_norm &lt; params_.tolerance) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;[Info] Newton: Converged after &quot;</span> &lt;&lt; iter &lt;&lt; <span class="stringliteral">&quot; iterations.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="comment">// Newton step: delta = -H^{-1} * grad. For diagonal H, H_ii^{-1} = 1/H_ii</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="comment">// Ensure no division by zero in hessian_diag before this step</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <a class="code" href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">StoringVector</a> delta = -grad.array() / hessian_diag.array();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            x += delta;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keywordflow">if</span> (iter == params_.max_iter - 1) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;[Warning] Newton: Reached max iterations (&quot;</span> &lt;&lt; params_.max_iter &lt;&lt; <span class="stringliteral">&quot;).&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        this-&gt;quantization.row(0) = x.transpose(); <span class="comment">// Store result</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;     }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#aee040a99dca9cf2d2db78f373ce1e456">  239</a></span>&#160;    Params <a class="code" href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#aee040a99dca9cf2d2db78f373ce1e456">params_</a>; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#a791302989b09b5f05852c8c8f23960c4">  251</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#a791302989b09b5f05852c8c8f23960c4">computeGradientAndHessian</a>(<span class="keyword">const</span> <a class="code" href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">StoringVector</a>&amp; q_points, <span class="comment">// q_points is N_points x 1</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                   <a class="code" href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">StoringVector</a>&amp; grad,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                   <a class="code" href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">StoringVector</a>&amp; hess_diag) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">// grad and hess_diag should be N_points x 1</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        grad.setZero();</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        hess_diag.setConstant(<span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1e-9)); <span class="comment">// Small positive for stability</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keyword">auto</span> normal_density = <a class="code" href="namespacestats.html#a0c87f9beaf85f1a38430672a06591e86">stats::make_normal_density</a>(<span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(0.0), <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1.0));</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">StoringVector</a> a_boundaries(N_points), b_boundaries(N_points);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment">// Voronoi boundaries: a_i = (q_{i-1} + q_i)/2, b_i = (q_i + q_{i+1})/2</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        a_boundaries(0) = -std::numeric_limits&lt;T&gt;::infinity();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">if</span> (N_points &gt; 1) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="keywordflow">for</span> (std::size_t i = 1; i &lt; N_points; ++i) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                a_boundaries(i) = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(0.5) * (q_points(i - 1) + q_points(i));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        b_boundaries(N_points - 1) = std::numeric_limits&lt;T&gt;::infinity();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">if</span> (N_points &gt; 1) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; N_points - 1; ++i) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                b_boundaries(i) = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(0.5) * (q_points(i) + q_points(i + 1));</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">// This is the formulation from &quot;Optimal quantizers for standard Gaussian distribution&quot; by Printems (2001) </span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">// grad_i = 2 * ( q_i * (cdf(b_i) - cdf(a_i)) - (pdf(b_i) - pdf(a_i)) )  -- this formula seems reversed from a minimization perspective</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment">// Or from &quot;Optimal quadratic quantization for a gauss Markov source&quot; (Paige/Printems) where dD/dx_i is given</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="comment">// dD/dx_i = 2 * integral_{x_i in V_i} (x_i - y) phi(y) dy</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">// For 1D, integral (x_i - y)phi(y)dy = x_i * (F(b_i)-F(a_i)) - (phi(a_i)-phi(b_i)) (using -phi&#39;(y)=y*phi(y) so integral y*phi(y) = -phi(y))</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="comment">// The gradient of D = sum_i integral_{y in V_i} (y - q_i)^2 phi(y) dy w.r.t q_i is -2 * integral_{y in V_i} (y - q_i) phi(y) dy</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="comment">// = -2 * [ integral y*phi(y)dy - q_i * integral phi(y)dy ]</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="comment">// = -2 * [ (-phi(b_i) - (-phi(a_i))) - q_i * (F(b_i) - F(a_i)) ]</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">// = -2 * [ phi(a_i) - phi(b_i) - q_i * (F(b_i) - F(a_i)) ]</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">// =  2 * [ q_i * (F(b_i) - F(a_i)) - (phi(a_i) - phi(b_i)) ]</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="comment">// The Hessian (diagonal elements for 1D Lloyd-Max type problem) is d^2D/dq_i^2 = 2 * (F(b_i) - F(a_i))</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">        #pragma omp parallel for schedule(static)</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; N_points; ++i) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            T Fa = normal_density.cdf(a_boundaries(i));</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            T Fb = normal_density.cdf(b_boundaries(i));</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            T pdf_a = normal_density.pdf(a_boundaries(i));</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            T pdf_b = normal_density.pdf(b_boundaries(i));</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            T Z_i = Fb - Fa; <span class="comment">// Probability mass in Voronoi cell i</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">if</span> (Z_i &gt; std::numeric_limits&lt;T&gt;::epsilon()) { <span class="comment">// Avoid division by zero or instability</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <span class="comment">// Gradient component for q_i</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                grad(i) = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(2.0) * (q_points(i) * Z_i - (pdf_a - pdf_b));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <span class="comment">// Hessian diagonal component for q_i</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                hess_diag(i) = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(2.0) * Z_i;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keywordflow">if</span> (hess_diag(i) &lt; <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1e-9)) { <span class="comment">// Floor hessian component</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                     hess_diag(i) = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1e-9);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                grad(i) = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(0.0);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                hess_diag(i) = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1.0); <span class="comment">// Or a small stable value if Z_i is effectively zero</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;};</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keyword">template</span> &lt;std::<span class="keywordtype">size_t</span> N_po<span class="keywordtype">int</span>s, std::<span class="keywordtype">size_t</span> Dim_val, <span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html">  326</a></span>&#160;<span class="keyword">class </span><a class="code" href="classstats_1_1_quantizer.html">Quantizer</a>&lt;N_points, Dim_val, <a class="code" href="namespacestats.html#a21575c8abdf444ef417939c6d5dbf018">QuantizationProcedure</a>::<a class="code" href="_o_p_o_e__traits_8hpp.html#a23239ce06a79e5103dfdf77c9299f9cca18404ae18ea5a0144a5dffc87cb03fc5">CLVQ</a>, T&gt; : <span class="keyword">public</span> <a class="code" href="classstats_1_1_quantizer_base.html">QuantizerBase</a>&lt;N_points, Dim_val, T&gt; {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="structstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_1_1_params.html">  331</a></span>&#160;    <span class="keyword">struct </span>Params {</div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="structstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_1_1_params.html#a95e81b4dcdc2154ed0bc627fa6b546f2">  332</a></span>&#160;        T initial_gamma_0_base{0.1};               </div>
<div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="structstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_1_1_params.html#a0d32333282b887b757c663e1930bd233">  333</a></span>&#160;        std::size_t epochs{10000};                 </div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="structstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_1_1_params.html#aae342ccd61febce5093acb1f86be8e00">  334</a></span>&#160;        T convergence_tolerance{1e-5};             </div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="structstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_1_1_params.html#ac01a568b527622011b6a40077c384f04">  335</a></span>&#160;        <span class="keywordtype">int</span> distortion_check_interval{1000};       </div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="structstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_1_1_params.html#aab2f2b97fc94c383453df827a9479120">  336</a></span>&#160;        <span class="keywordtype">int</span> num_samples_for_distortion_eval{5000}; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="structstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_1_1_params.html#a22ee04c34f760d734a5c02bf23760927">  347</a></span>&#160;        <a class="code" href="structstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_1_1_params.html#a22ee04c34f760d734a5c02bf23760927">Params</a>(T gamma_base = 0.1, std::size_t ep = 10000, T tol = 1e-5, <span class="keywordtype">int</span> dist_interval = 1000, <span class="keywordtype">int</span> dist_samples = 5000)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            : initial_gamma_0_base(gamma_base), epochs(ep), convergence_tolerance(tol),</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;              distortion_check_interval(dist_interval), num_samples_for_distortion_eval(dist_samples) {}</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    };</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#aefca29fbe1c07fa54c1060f28ec8e19b">  357</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#aefca29fbe1c07fa54c1060f28ec8e19b">Quantizer</a>(<span class="keyword">const</span> Params&amp; params = Params{})</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        : <a class="code" href="classstats_1_1_quantizer_base.html">QuantizerBase&lt;N_points, Dim_val, T&gt;</a>(), params_(params),</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;          weights_(StoringVector::Constant(N_points, <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1.0) / <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(N_points))) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        initializeHints();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#a98c80962e14f2ec8ed8045d1c96107e3">  366</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#a98c80962e14f2ec8ed8045d1c96107e3">initializeHints</a>() {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        std::random_device rd;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        std::mt19937 gen(rd());</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        std::normal_distribution&lt;T&gt; dist(<span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(0.0), <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1.0));</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="comment">// this-&gt;hints is Dim_val x N_points</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        this-&gt;hints = Utils::sampler&lt;T&gt;(gen, dist, Dim_val, N_points);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#a393cf9cdee4d15d94f107a4da453bc80">  381</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#a393cf9cdee4d15d94f107a4da453bc80">run</a>() {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        std::random_device rd_train, rd_dist;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        std::mt19937 training_generator(rd_train());</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        std::mt19937 distortion_eval_generator(rd_dist());</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        std::normal_distribution&lt;T&gt; standard_normal_dist(<span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(0.0), <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1.0));</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="comment">// --- Initial Overall Distortion ---</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        T last_overall_distortion = Utils::calculate_overall_distortion&lt;T, Dim_val&gt;(</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            this-&gt;hints, params_.num_samples_for_distortion_eval, distortion_eval_generator, standard_normal_dist</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        );</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;[Info] CLVQ Initial Overall Distortion: &quot;</span> &lt;&lt; last_overall_distortion &lt;&lt; std::endl;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="comment">// --- Learning Rate (gamma) Parameters ---</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keyword">const</span> T initial_gamma_0 = params_.initial_gamma_0_base; <span class="comment">// Simpler: use base directly</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keyword">const</span> T K_centroids = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(N_points);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keyword">const</span> T const_a_lr = 4.0 * std::pow(K_centroids, 1.0 / <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(Dim_val));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keyword">const</span> T const_b_lr = M_PI * M_PI * std::pow(K_centroids, -2.0 / <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(Dim_val));</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">// --- Online Distortion Estimate (EMA) ---</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        T online_distortion_estimate_ema = last_overall_distortion; <span class="comment">// Initialize with the first true calculation</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;[Info] CLVQ: Starting training for &quot;</span> &lt;&lt; params_.epochs &lt;&lt; <span class="stringliteral">&quot; samples.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;[Info] CLVQ: Centroid matrix dimensions: &quot;</span> &lt;&lt; this-&gt;hints.rows() &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; this-&gt;hints.cols() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">for</span> (std::size_t iter_idx = 0; iter_idx &lt; params_.epochs; ++iter_idx) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="comment">// 1. Sample a data point (eta)</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <a class="code" href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">StoringVector</a> eta = Utils::sampler&lt;T&gt;(</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                training_generator, standard_normal_dist, Dim_val <span class="comment">// Dim_val for dimension, 1 sample</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            );</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="comment">// 2. Find the winning centroid for eta</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keyword">auto</span> argmin_result = Utils::argmin&lt;T&gt;(this-&gt;hints, eta); <span class="comment">// Returns std::tuple&lt;int, T, RowVector&gt;</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="keywordtype">int</span> winner_index = std::get&lt;0&gt;(argmin_result);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            T l2_dist_eta_to_winner = std::get&lt;1&gt;(argmin_result);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keywordflow">if</span> (winner_index == -1) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;[Warning] CLVQ Iter &quot;</span> &lt;&lt; iter_idx &lt;&lt; <span class="stringliteral">&quot;: No winning centroid found. Skipping update.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="comment">// 3. Calculate learning rate (gamma)</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            T time_step_t = <span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(iter_idx + 1);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            T gamma = initial_gamma_0 * const_a_lr / (time_step_t * const_b_lr * initial_gamma_0 + const_a_lr);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="comment">// 4. Update centroid</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            this-&gt;hints.col(winner_index) += gamma * (eta - this-&gt;hints.col(winner_index));</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="comment">// 5. Update weights (conscience mechanism / frequency counting)</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordflow">if</span> (this-&gt;weights_.size() == N_points) { <span class="comment">// Safety check</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                 this-&gt;weights_ *= (<span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1.0) - gamma); <span class="comment">// Decay all</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                 this-&gt;weights_(winner_index) += gamma;         <span class="comment">// Increment winner</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="comment">// 6. Update online distortion estimate (EMA)</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            T squared_l2_dist_eta_to_winner = l2_dist_eta_to_winner * l2_dist_eta_to_winner;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            online_distortion_estimate_ema = (<span class="keyword">static_cast&lt;</span>T<span class="keyword">&gt;</span>(1.0) - gamma) * online_distortion_estimate_ema + gamma * squared_l2_dist_eta_to_winner;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">// --- Final Evaluation &amp; Printouts ---</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        T final_overall_distortion = Utils::calculate_overall_distortion&lt;T, Dim_val&gt;(</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            this-&gt;hints, params_.num_samples_for_distortion_eval * 2, <span class="comment">// Use more samples for final</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            distortion_eval_generator, standard_normal_dist</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        );</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        this-&gt;quantization = this-&gt;hints; <span class="comment">// Store the final learned hints as the quantization result</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;[Info] CLVQ training finished.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;[Info] CLVQ Final Overall Distortion: &quot;</span> &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; final_overall_distortion &lt;&lt; std::endl;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">if</span> (this-&gt;weights_.size() &gt; 0) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;             std::cout &lt;&lt; <span class="stringliteral">&quot;[Info] CLVQ Sum of final weights: &quot;</span> &lt;&lt; this-&gt;weights_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;             <span class="comment">// std::cout &lt;&lt; &quot;[Info] CLVQ Final weights (transpose):\n&quot; &lt;&lt; this-&gt;weights_.transpose() &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#aa72dac1dd0c4629eb934712491cf8eb6">  462</a></span>&#160;    Params <a class="code" href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#aa72dac1dd0c4629eb934712491cf8eb6">params_</a>;</div>
<div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#af376b0c73e34251bbaaa3b31702a9a56">  463</a></span>&#160;    <a class="code" href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">StoringVector</a> <a class="code" href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#af376b0c73e34251bbaaa3b31702a9a56">weights_</a>; <span class="comment">// StoringVector should be N_points x 1</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;};</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;} <span class="comment">// namespace stats</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">// QUANTIZATION_HPP</span></div>
<div class="ttc" id="a_o_p_o_e__traits_8hpp_html_a23239ce06a79e5103dfdf77c9299f9cc"><div class="ttname"><a href="_o_p_o_e__traits_8hpp.html#a23239ce06a79e5103dfdf77c9299f9cc">QuantizationProcedure</a></div><div class="ttdeci">QuantizationProcedure</div><div class="ttdoc">Enumerates different quantization strategies.</div><div class="ttdef"><b>Definition:</b> <a href="_o_p_o_e__traits_8hpp_source.html#l00131">OPOE_traits.hpp:132</a></div></div>
<div class="ttc" id="a_o_p_o_e__traits_8hpp_html_a23239ce06a79e5103dfdf77c9299f9cca18404ae18ea5a0144a5dffc87cb03fc5"><div class="ttname"><a href="_o_p_o_e__traits_8hpp.html#a23239ce06a79e5103dfdf77c9299f9cca18404ae18ea5a0144a5dffc87cb03fc5">QuantizationProcedure::CLVQ</a></div><div class="ttdeci">@ CLVQ</div><div class="ttdoc">Competitive Learning Vector Quantization.</div></div>
<div class="ttc" id="a_o_p_o_e__traits_8hpp_html_a23239ce06a79e5103dfdf77c9299f9cca1c8b97c83b0726216cd5dbc88a64b0ed"><div class="ttname"><a href="_o_p_o_e__traits_8hpp.html#a23239ce06a79e5103dfdf77c9299f9cca1c8b97c83b0726216cd5dbc88a64b0ed">QuantizationProcedure::Newton</a></div><div class="ttdeci">@ Newton</div><div class="ttdoc">Quantization using Newton-based optimization.</div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4_html_a06dedc6d4d63f79b17201282f2ffa973"><div class="ttname"><a href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#a06dedc6d4d63f79b17201282f2ffa973">stats::Quantizer&lt; N_points, 1, QuantizationProcedure::Newton, T &gt;::run</a></div><div class="ttdeci">void run()</div><div class="ttdoc">Runs Newton's method to optimize quantizer centroids.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00208">Quantization.hpp:208</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4_html_a59c08c7a333926618662d1d67da55cc4"><div class="ttname"><a href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#a59c08c7a333926618662d1d67da55cc4">stats::Quantizer&lt; N_points, 1, QuantizationProcedure::Newton, T &gt;::Quantizer</a></div><div class="ttdeci">Quantizer(const Params &amp;params=Params{})</div><div class="ttdoc">Constructor for the 1D Newton quantizer.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00178">Quantization.hpp:178</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4_html_a791302989b09b5f05852c8c8f23960c4"><div class="ttname"><a href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#a791302989b09b5f05852c8c8f23960c4">stats::Quantizer&lt; N_points, 1, QuantizationProcedure::Newton, T &gt;::computeGradientAndHessian</a></div><div class="ttdeci">void computeGradientAndHessian(const StoringVector &amp;q_points, StoringVector &amp;grad, StoringVector &amp;hess_diag)</div><div class="ttdoc">Computes the gradient and diagonal Hessian of the distortion function.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00251">Quantization.hpp:251</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4_html_a8824558b30603668d2efd145c1e05ada"><div class="ttname"><a href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#a8824558b30603668d2efd145c1e05ada">stats::Quantizer&lt; N_points, 1, QuantizationProcedure::Newton, T &gt;::initializeHints</a></div><div class="ttdeci">void initializeHints()</div><div class="ttdoc">Initializes hints using a uniform grid over [-4, 4].</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00188">Quantization.hpp:188</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4_html_aee040a99dca9cf2d2db78f373ce1e456"><div class="ttname"><a href="classstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4.html#aee040a99dca9cf2d2db78f373ce1e456">stats::Quantizer&lt; N_points, 1, QuantizationProcedure::Newton, T &gt;::params_</a></div><div class="ttdeci">Params params_</div><div class="ttdoc">Newton method parameters.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00239">Quantization.hpp:239</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_html_a393cf9cdee4d15d94f107a4da453bc80"><div class="ttname"><a href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#a393cf9cdee4d15d94f107a4da453bc80">stats::Quantizer&lt; N_points, Dim_val, QuantizationProcedure::CLVQ, T &gt;::run</a></div><div class="ttdeci">void run()</div><div class="ttdoc">Runs the CLVQ training loop.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00381">Quantization.hpp:381</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_html_a98c80962e14f2ec8ed8045d1c96107e3"><div class="ttname"><a href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#a98c80962e14f2ec8ed8045d1c96107e3">stats::Quantizer&lt; N_points, Dim_val, QuantizationProcedure::CLVQ, T &gt;::initializeHints</a></div><div class="ttdeci">void initializeHints()</div><div class="ttdoc">Initializes centroids (hints) with samples from a standard normal distribution.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00366">Quantization.hpp:366</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_html_aa72dac1dd0c4629eb934712491cf8eb6"><div class="ttname"><a href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#aa72dac1dd0c4629eb934712491cf8eb6">stats::Quantizer&lt; N_points, Dim_val, QuantizationProcedure::CLVQ, T &gt;::params_</a></div><div class="ttdeci">Params params_</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00462">Quantization.hpp:462</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_html_aefca29fbe1c07fa54c1060f28ec8e19b"><div class="ttname"><a href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#aefca29fbe1c07fa54c1060f28ec8e19b">stats::Quantizer&lt; N_points, Dim_val, QuantizationProcedure::CLVQ, T &gt;::Quantizer</a></div><div class="ttdeci">Quantizer(const Params &amp;params=Params{})</div><div class="ttdoc">Constructor for the CLVQ Quantizer.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00357">Quantization.hpp:357</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_html_af376b0c73e34251bbaaa3b31702a9a56"><div class="ttname"><a href="classstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4.html#af376b0c73e34251bbaaa3b31702a9a56">stats::Quantizer&lt; N_points, Dim_val, QuantizationProcedure::CLVQ, T &gt;::weights_</a></div><div class="ttdeci">StoringVector weights_</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00463">Quantization.hpp:463</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_base_html"><div class="ttname"><a href="classstats_1_1_quantizer_base.html">stats::QuantizerBase</a></div><div class="ttdoc">Base class template for quantizer implementations.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00086">Quantization.hpp:86</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_base_html_a039808f597fe95fd6a7d0af2b96ca1ba"><div class="ttname"><a href="classstats_1_1_quantizer_base.html#a039808f597fe95fd6a7d0af2b96ca1ba">stats::QuantizerBase::quantization</a></div><div class="ttdeci">QuantizerGrid quantization</div><div class="ttdoc">Final optimized quantizer grid of size Dim × N_points.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00136">Quantization.hpp:136</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_base_html_a3792b9bb0b17cb45889e190877dfcae6"><div class="ttname"><a href="classstats_1_1_quantizer_base.html#a3792b9bb0b17cb45889e190877dfcae6">stats::QuantizerBase::getDim</a></div><div class="ttdeci">std::size_t getDim() const noexcept</div><div class="ttdoc">Gets the dimensionality of the quantization space.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00125">Quantization.hpp:125</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_base_html_a4dda7216581e12762476dd2d554b7a25"><div class="ttname"><a href="classstats_1_1_quantizer_base.html#a4dda7216581e12762476dd2d554b7a25">stats::QuantizerBase::~QuantizerBase</a></div><div class="ttdeci">virtual ~QuantizerBase()=default</div><div class="ttdoc">Virtual destructor.</div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_base_html_a5aaa041f23256a56fe92cc690c73b67a"><div class="ttname"><a href="classstats_1_1_quantizer_base.html#a5aaa041f23256a56fe92cc690c73b67a">stats::QuantizerBase::QuantizerBase</a></div><div class="ttdeci">QuantizerBase()</div><div class="ttdoc">Default constructor for the base quantizer.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00097">Quantization.hpp:97</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_base_html_aa83be6067337c4e59117b3ee53b94fb5"><div class="ttname"><a href="classstats_1_1_quantizer_base.html#aa83be6067337c4e59117b3ee53b94fb5">stats::QuantizerBase::getQuantization</a></div><div class="ttdeci">const QuantizerGrid &amp; getQuantization() const noexcept</div><div class="ttdoc">Retrieves the current quantization grid (centroids).</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00111">Quantization.hpp:111</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_base_html_abeed508991d5d32ee655484f9998e8b6"><div class="ttname"><a href="classstats_1_1_quantizer_base.html#abeed508991d5d32ee655484f9998e8b6">stats::QuantizerBase::getNumPoints</a></div><div class="ttdeci">std::size_t getNumPoints() const noexcept</div><div class="ttdoc">Gets the number of quantization points.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00118">Quantization.hpp:118</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_base_html_ac80a32f7d50aec8fe22447ba4564a3a2"><div class="ttname"><a href="classstats_1_1_quantizer_base.html#ac80a32f7d50aec8fe22447ba4564a3a2">stats::QuantizerBase::getHints</a></div><div class="ttdeci">const QuantizerGrid &amp; getHints() const noexcept</div><div class="ttdoc">Retrieves the initialization hints for the quantizer.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00132">Quantization.hpp:132</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_base_html_af16831bbe8b705be51d99054603d1cd3"><div class="ttname"><a href="classstats_1_1_quantizer_base.html#af16831bbe8b705be51d99054603d1cd3">stats::QuantizerBase::hints</a></div><div class="ttdeci">QuantizerGrid hints</div><div class="ttdoc">Hint matrix (initial centroids) of size Dim × N_points.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00135">Quantization.hpp:135</a></div></div>
<div class="ttc" id="aclassstats_1_1_quantizer_html"><div class="ttname"><a href="classstats_1_1_quantizer.html">stats::Quantizer</a></div><div class="ttdoc">Forward declaration of Quantizer class.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00073">Quantization.hpp:73</a></div></div>
<div class="ttc" id="amain_8cpp_html_a2bed6660252a8734620907db5c512d41"><div class="ttname"><a href="main_8cpp.html#a2bed6660252a8734620907db5c512d41">StoringVector</a></div><div class="ttdeci">Eigen::VectorXd StoringVector</div><div class="ttdef"><b>Definition:</b> <a href="main_8cpp_source.html#l00025">main.cpp:25</a></div></div>
<div class="ttc" id="anamespacestats_html"><div class="ttname"><a href="namespacestats.html">stats</a></div><div class="ttdef"><b>Definition:</b> <a href="_density_base_8hpp_source.html#l00051">DensityBase.hpp:51</a></div></div>
<div class="ttc" id="anamespacestats_html_a0c87f9beaf85f1a38430672a06591e86"><div class="ttname"><a href="namespacestats.html#a0c87f9beaf85f1a38430672a06591e86">stats::make_normal_density</a></div><div class="ttdeci">auto make_normal_density(Args &amp;&amp;... args)</div><div class="ttdoc">Factory for a BoostBaseDensity using normal_distribution.</div><div class="ttdef"><b>Definition:</b> <a href="_density_base_8hpp_source.html#l00364">DensityBase.hpp:364</a></div></div>
<div class="ttc" id="anamespacestats_html_a21575c8abdf444ef417939c6d5dbf018"><div class="ttname"><a href="namespacestats.html#a21575c8abdf444ef417939c6d5dbf018">stats::QuantizationProcedure</a></div><div class="ttdeci">traits::QuantizationProcedure QuantizationProcedure</div><div class="ttdoc">Type alias for quantization procedures defined in traits.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00056">Quantization.hpp:56</a></div></div>
<div class="ttc" id="anamespacestats_html_a84fdcf5df98e5461134cd00982a55216"><div class="ttname"><a href="namespacestats.html#a84fdcf5df98e5461134cd00982a55216">stats::StoringVector</a></div><div class="ttdeci">traits::DataType::StoringVector StoringVector</div><div class="ttdoc">Type alias for vector storage type used in quantization.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00056">Quantization.hpp:56</a></div></div>
<div class="ttc" id="anamespacestats_html_a85770edc239c1c8c5bd5029a48749014"><div class="ttname"><a href="namespacestats.html#a85770edc239c1c8c5bd5029a48749014">stats::QuantizerGrid</a></div><div class="ttdeci">traits::DataType::StoringMatrix QuantizerGrid</div><div class="ttdoc">Type alias for vector storage type used in quantization.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00062">Quantization.hpp:62</a></div></div>
<div class="ttc" id="astructstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4_1_1_params_html_a5e8f7f9d179863fdcb5be05e87ad5722"><div class="ttname"><a href="structstats_1_1_quantizer_3_01_n__points_00_011_00_01_quantization_procedure_1_1_newton_00_01_t_01_4_1_1_params.html#a5e8f7f9d179863fdcb5be05e87ad5722">stats::Quantizer&lt; N_points, 1, QuantizationProcedure::Newton, T &gt;::Params::Params</a></div><div class="ttdeci">Params(T tol=1e-5, std::size_t max_it=1000)</div><div class="ttdoc">Constructor for custom parameters.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00167">Quantization.hpp:167</a></div></div>
<div class="ttc" id="astructstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_1_1_params_html_a22ee04c34f760d734a5c02bf23760927"><div class="ttname"><a href="structstats_1_1_quantizer_3_01_n__points_00_01_dim__val_00_01_quantization_procedure_1_1_c_l_v_q_00_01_t_01_4_1_1_params.html#a22ee04c34f760d734a5c02bf23760927">stats::Quantizer&lt; N_points, Dim_val, QuantizationProcedure::CLVQ, T &gt;::Params::Params</a></div><div class="ttdeci">Params(T gamma_base=0.1, std::size_t ep=10000, T tol=1e-5, int dist_interval=1000, int dist_samples=5000)</div><div class="ttdoc">Constructor for CLVQ parameters.</div><div class="ttdef"><b>Definition:</b> <a href="_quantization_8hpp_source.html#l00347">Quantization.hpp:347</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
