<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OPE: stats/MixtureDensity.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OPE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a2a5b97680f4688c5edec2038dd4832f.html">stats</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#typedef-members">Typedefs</a>  </div>
  <div class="headertitle">
<div class="title">MixtureDensity.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Defines the MixtureDensity class template for representing and manipulating mixtures of probability density functions (PDFs) with orthogonal polynomial bases.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;vector&gt;</code><br />
<code>#include &lt;variant&gt;</code><br />
<code>#include &lt;numeric&gt;</code><br />
<code>#include &lt;stdexcept&gt;</code><br />
<code>#include &lt;limits&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;typeinfo&gt;</code><br />
<code>#include &lt;tuple&gt;</code><br />
<code>#include &lt;utility&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &quot;<a class="el" href="_density_base_8hpp_source.html">DensityBase.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_orthogonal_polynomials_8hpp_source.html">../polynomials/OrthogonalPolynomials.hpp</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for MixtureDensity.hpp:</div>
<div class="dyncontent">
<div class="center"><img src="_mixture_density_8hpp__incl.png" border="0" usemap="#astats_2_mixture_density_8hpp" alt=""/></div>
<map name="astats_2_mixture_density_8hpp" id="astats_2_mixture_density_8hpp">
<area shape="rect" title="Defines the MixtureDensity class template for representing and manipulating mixtures of probability d..." alt="" coords="1535,5,1719,32"/>
<area shape="rect" title=" " alt="" coords="2119,408,2182,435"/>
<area shape="rect" title=" " alt="" coords="2211,408,2279,435"/>
<area shape="rect" title=" " alt="" coords="45,326,120,353"/>
<area shape="rect" title=" " alt="" coords="1395,326,1482,353"/>
<area shape="rect" title=" " alt="" coords="1507,326,1565,353"/>
<area shape="rect" title=" " alt="" coords="1896,326,1976,353"/>
<area shape="rect" title=" " alt="" coords="145,326,221,353"/>
<area shape="rect" title=" " alt="" coords="1077,408,1131,435"/>
<area shape="rect" title=" " alt="" coords="2001,326,2061,353"/>
<area shape="rect" title=" " alt="" coords="3366,244,3453,271"/>
<area shape="rect" href="_density_base_8hpp.html" title="Provides a generic base class for probability density functions using Boost.Math distributions." alt="" coords="1177,244,1309,271"/>
<area shape="rect" href="_orthogonal_polynomials_8hpp.html" title="Defines a generic CRTP&#45;based framework for orthogonal polynomials and their specializations." alt="" coords="2507,80,2698,121"/>
<area shape="rect" title=" " alt="" coords="2003,408,2095,435"/>
<area shape="rect" title=" " alt="" coords="883,319,1064,360"/>
<area shape="rect" title=" " alt="" coords="1088,319,1269,360"/>
<area shape="rect" title=" " alt="" coords="296,319,477,360"/>
<area shape="rect" title=" " alt="" coords="501,319,683,360"/>
<area shape="rect" title=" " alt="" coords="707,319,858,360"/>
<area shape="rect" href="_o_p_o_e__traits_8hpp.html" title="Defines core type traits, enumerations, and data structures for the OPOE library." alt="" coords="2481,326,2658,353"/>
<area shape="rect" title=" " alt="" coords="2639,408,2742,435"/>
<area shape="rect" title=" " alt="" coords="2415,408,2521,435"/>
<area shape="rect" title=" " alt="" coords="3188,408,3244,435"/>
<area shape="rect" title=" " alt="" coords="2983,408,3046,435"/>
<area shape="rect" title=" " alt="" coords="2545,408,2604,435"/>
<area shape="rect" title=" " alt="" coords="2306,408,2385,435"/>
<area shape="rect" href="_polynomials_8hpp.html" title="Defines the polynomials::Polynomial template class and related polynomial operations." alt="" coords="2537,169,2668,196"/>
<area shape="rect" href="_orthogonal_validator_8cpp.html" title=" " alt="" coords="1955,169,2133,196"/>
<area shape="rect" title=" " alt="" coords="2692,169,2769,196"/>
<area shape="rect" title=" " alt="" coords="2399,244,2484,271"/>
<area shape="rect" title=" " alt="" coords="2509,244,2595,271"/>
<area shape="rect" title=" " alt="" coords="2620,244,2687,271"/>
<area shape="rect" title=" " alt="" coords="2711,244,2795,271"/>
<area shape="rect" href="_utils_8hpp.html" title="Utility functions and templates for polynomial operations, random sampling, and vector/matrix computa..." alt="" coords="2819,244,2943,271"/>
<area shape="rect" href="_f_f_t_w_8hpp.html" title="Utilities for performing FFT&#45;based polynomial multiplication using FFTW and Eigen." alt="" coords="2245,244,2374,271"/>
<area shape="rect" title=" " alt="" coords="2733,326,2805,353"/>
<area shape="rect" title=" " alt="" coords="2830,326,2954,353"/>
<area shape="rect" title=" " alt="" coords="2978,319,3190,360"/>
<area shape="rect" title=" " alt="" coords="2187,326,2253,353"/>
<area shape="rect" title=" " alt="" coords="1943,244,2017,271"/>
<area shape="rect" href="_orthogonal_validator_8hpp.html" title="Provides utilities for validating domains and parameters of orthogonal polynomials." alt="" coords="1537,244,1716,271"/>
<area shape="rect" title=" " alt="" coords="1640,326,1720,353"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="_mixture_density_8hpp__dep__incl.png" border="0" usemap="#astats_2_mixture_density_8hppdep" alt=""/></div>
<map name="astats_2_mixture_density_8hppdep" id="astats_2_mixture_density_8hppdep">
<area shape="rect" title="Defines the MixtureDensity class template for representing and manipulating mixtures of probability d..." alt="" coords="17,5,201,32"/>
<area shape="rect" href="_o_p_e_option_pricer_8hpp.html" title="Defines the OPEOptionPricer class for pricing options using Orthogonal Polynomial Expansion (OPE)." alt="" coords="5,80,212,107"/>
<area shape="rect" href="main_8cpp.html" title=" " alt="" coords="67,155,150,181"/>
</map>
</div>
</div>
<p><a href="_mixture_density_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstats_1_1_density_to_poly_traits.html">stats::DensityToPolyTraits&lt; Density, N, R &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Traits class mapping a Density type to its associated orthogonal polynomial type.  <a href="structstats_1_1_density_to_poly_traits.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstats_1_1_density_to_poly_traits_3_01_normal_density_00_01_n_00_01_r_01_4.html">stats::DensityToPolyTraits&lt; NormalDensity, N, R &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specialization mapping NormalDensity to HermitePolynomial.  <a href="structstats_1_1_density_to_poly_traits_3_01_normal_density_00_01_n_00_01_r_01_4.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstats_1_1_density_to_poly_traits_3_01_beta_density_00_01_n_00_01_r_01_4.html">stats::DensityToPolyTraits&lt; BetaDensity, N, R &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specialization mapping BetaDensity to JacobiPolynomial.  <a href="structstats_1_1_density_to_poly_traits_3_01_beta_density_00_01_n_00_01_r_01_4.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstats_1_1_density_to_poly_traits_3_01_gamma_density_00_01_n_00_01_r_01_4.html">stats::DensityToPolyTraits&lt; GammaDensity, N, R &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specialization mapping GammaDensity to LaguerrePolynomial.  <a href="structstats_1_1_density_to_poly_traits_3_01_gamma_density_00_01_n_00_01_r_01_4.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstats_1_1_mixture_density.html">stats::MixtureDensity&lt; PolynomialBaseDegree, DensityType, R &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classstats_1_1_mixture_density.html" title="MixtureDensity class template for polynomial-based mixture density estimation.">MixtureDensity</a> class template for polynomial-based mixture density estimation.  <a href="classstats_1_1_mixture_density.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacestats"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacestats.html">stats</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aba57969e7366158195ee641ed7e901df"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacestats.html#aba57969e7366158195ee641ed7e901df">stats::NormalDensity</a> = decltype(<a class="el" href="namespacestats.html#a0c87f9beaf85f1a38430672a06591e86">stats::make_normal_density</a>(0.0, 1.0))</td></tr>
<tr class="memdesc:aba57969e7366158195ee641ed7e901df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alias for a normal distribution wrapped in <a class="el" href="classstats_1_1_boost_base_density.html" title="Generic wrapper for Boost continuous probability distributions.">BoostBaseDensity</a>.  <a href="namespacestats.html#aba57969e7366158195ee641ed7e901df">More...</a><br /></td></tr>
<tr class="separator:aba57969e7366158195ee641ed7e901df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabf10d14834b4895a4f4915d9b93b371"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacestats.html#aabf10d14834b4895a4f4915d9b93b371">stats::GammaDensity</a> = decltype(<a class="el" href="namespacestats.html#a52a655fbb4fb35e01f3e77c10fbab1ce">stats::make_gamma_density</a>(1.0, 1.0))</td></tr>
<tr class="memdesc:aabf10d14834b4895a4f4915d9b93b371"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alias for a gamma distribution wrapped in <a class="el" href="classstats_1_1_boost_base_density.html" title="Generic wrapper for Boost continuous probability distributions.">BoostBaseDensity</a>.  <a href="namespacestats.html#aabf10d14834b4895a4f4915d9b93b371">More...</a><br /></td></tr>
<tr class="separator:aabf10d14834b4895a4f4915d9b93b371"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0ad14447bcd745153e665fa2b961f0a"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacestats.html#af0ad14447bcd745153e665fa2b961f0a">stats::BetaDensity</a> = decltype(<a class="el" href="namespacestats.html#a029f8cb8096ad665711c5102d7f51696">stats::make_beta_density</a>(1.0, 1.0))</td></tr>
<tr class="memdesc:af0ad14447bcd745153e665fa2b961f0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alias for a beta distribution wrapped in <a class="el" href="classstats_1_1_boost_base_density.html" title="Generic wrapper for Boost continuous probability distributions.">BoostBaseDensity</a>.  <a href="namespacestats.html#af0ad14447bcd745153e665fa2b961f0a">More...</a><br /></td></tr>
<tr class="separator:af0ad14447bcd745153e665fa2b961f0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaacf7ce6a573dd7a36fef376a0f421d6"><td class="memTemplParams" colspan="2">template&lt;unsigned int N, typename R  = traits::DataType::PolynomialField&gt; </td></tr>
<tr class="memitem:aaacf7ce6a573dd7a36fef376a0f421d6"><td class="memTemplItemLeft" align="right" valign="top">using&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacestats.html#aaacf7ce6a573dd7a36fef376a0f421d6">stats::Polynomial</a> = <a class="el" href="classpolynomials_1_1_polynomial.html">polynomials::Polynomial</a>&lt; N, R &gt;</td></tr>
<tr class="memdesc:aaacf7ce6a573dd7a36fef376a0f421d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alias for a compile-time polynomial type.  <a href="namespacestats.html#aaacf7ce6a573dd7a36fef376a0f421d6">More...</a><br /></td></tr>
<tr class="separator:aaacf7ce6a573dd7a36fef376a0f421d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e1b21f748bef44129e1aff630ff118"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacestats.html#a04e1b21f748bef44129e1aff630ff118">stats::DensityVariant</a> = std::variant&lt; NormalDensity, GammaDensity, BetaDensity &gt;</td></tr>
<tr class="memdesc:a04e1b21f748bef44129e1aff630ff118"><td class="mdescLeft">&#160;</td><td class="mdescRight">A variant type that can hold any supported Boost density type.  <a href="namespacestats.html#a04e1b21f748bef44129e1aff630ff118">More...</a><br /></td></tr>
<tr class="separator:a04e1b21f748bef44129e1aff630ff118"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Defines the MixtureDensity class template for representing and manipulating mixtures of probability density functions (PDFs) with orthogonal polynomial bases. </p>
<p>Dependencies:</p><ul>
<li><a class="el" href="_density_base_8hpp.html" title="Provides a generic base class for probability density functions using Boost.Math distributions.">DensityBase.hpp</a>: Base class for probability density functions.</li>
<li><a class="el" href="_orthogonal_polynomials_8hpp.html" title="Defines a generic CRTP-based framework for orthogonal polynomials and their specializations.">OrthogonalPolynomials.hpp</a>: For polynomial operations and orthogonal polynomial bases.</li>
</ul>
<p>This header provides a flexible framework for constructing mixtures of various probability distributions (e.g., Normal, Gamma, Beta) and associating each component with its corresponding orthogonal polynomial basis (e.g., Hermite, Laguerre, Jacobi). The MixtureDensity class supports:</p><ul>
<li>Validation and storage of mixture weights and component densities.</li>
<li>Automatic selection and construction of the appropriate polynomial basis for each component via DensityToPolyTraits.</li>
<li>Computation of recursion coefficients for orthonormal polynomial basis construction using the mixture's weighted inner product.</li>
<li>Construction of the orthonormal polynomial basis for the mixture, including storage of polynomial coefficients and function representations.</li>
<li>Calculation of the mixture's PDF and CDF at arbitrary points.</li>
<li>Access to component parameters, polynomial bases, Jacobi matrices, and projection matrices.</li>
<li>Prevention of copy semantics for safety, with move semantics enabled.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Requires C++17 or later for features such as std::variant, std::apply, and fold expressions.</li>
<li>Relies on Eigen for matrix and vector operations, and OpenMP for parallelization.</li>
<li>Assumes that DensityType classes provide methods: pdf(x), cdf(x), getMu(), getSigma(), getAlpha(), getBeta(), getShape(), getScale(), getDomain(), getDistribution(), and getConstructorParameters().</li>
<li>The polynomial basis construction is tailored to the type of each component via DensityToPolyTraits specializations.</li>
</ul>
</dd></dl>
<h1><a class="anchor" id="MixtureDensity_Usage"></a>
Usage Example</h1>
<div class="fragment"><div class="line"><span class="keyword">using</span> Mixture = <a class="code" href="classstats_1_1_mixture_density.html">stats::MixtureDensity&lt;3, stats::NormalDensity&gt;</a>;</div>
<div class="line">std::vector&lt;double&gt; weights = {0.5, 0.5};</div>
<div class="line">std::vector&lt;stats::NormalDensity&gt; components = {<a class="code" href="namespacestats.html#a0c87f9beaf85f1a38430672a06591e86">stats::make_normal_density</a>(0.0, 1.0), <a class="code" href="namespacestats.html#a0c87f9beaf85f1a38430672a06591e86">stats::make_normal_density</a>(2.0, 1.0)};</div>
<div class="line">Mixture mixture(weights, components);</div>
<div class="line">mixture.constructOrthonormalBasis();</div>
<div class="line"><span class="keywordtype">double</span> value = mixture.pdf(1.0);</div>
<div class="ttc" id="aclassstats_1_1_mixture_density_html"><div class="ttname"><a href="classstats_1_1_mixture_density.html">stats::MixtureDensity</a></div><div class="ttdoc">MixtureDensity class template for polynomial-based mixture density estimation.</div><div class="ttdef"><b>Definition:</b> <a href="_mixture_density_8hpp_source.html#l00178">MixtureDensity.hpp:178</a></div></div>
<div class="ttc" id="anamespacestats_html_a0c87f9beaf85f1a38430672a06591e86"><div class="ttname"><a href="namespacestats.html#a0c87f9beaf85f1a38430672a06591e86">stats::make_normal_density</a></div><div class="ttdeci">auto make_normal_density(Args &amp;&amp;... args)</div><div class="ttdoc">Factory for a BoostBaseDensity using normal_distribution.</div><div class="ttdef"><b>Definition:</b> <a href="_density_base_8hpp_source.html#l00364">DensityBase.hpp:364</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition in file <a class="el" href="_mixture_density_8hpp_source.html">MixtureDensity.hpp</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
